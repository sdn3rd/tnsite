<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags and SEO (copied from index.html) -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tristan Nuvola - Contact</title>
    <meta name="description" content="Explore the profound and introspective poetry of Tristan Nuvola, weaving words like silk into a universe of emotion and depth.">
    <meta name="keywords" content="Tristan Nuvola, Poetry, Introspection, Emotion, Creative Writing, Autistic Poet, Cloud-Inspired, Literary Art">
    <meta name="author" content="Tristan Nuvola">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://tristannuvola.com/">
    
    <!-- Robots Meta Tag -->
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Tristan Nuvola - Poetry & Reflections">
    <meta property="og:description" content="Explore the profound and introspective poetry of Tristan Nuvola, weaving words like silk into a universe of emotion and depth.">
    <meta property="og:image" content="https://tristannuvola.com/images/preview.jpg"> 
    <meta property="og:url" content="https://tristannuvola.com/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Tristan Nuvola">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@tristannuvola">
    <meta name="twitter:creator" content="@tristannuvola">
    <meta name="twitter:title" content="Tristan Nuvola - Poetry & Reflections">
    <meta name="twitter:description" content="Explore the profound and introspective poetry of Tristan Nuvola, weaving words like silk into a universe of emotion and depth.">
    <meta name="twitter:image" content="https://tristannuvola.com/images/preview.jpg">
    
    <!-- oEmbed Discovery Links -->
    <link rel="alternate" type="application/json+oembed" href="https://tristannuvola.com/oembed?format=json" title="Tristan Nuvola oEmbed">
    <link rel="alternate" type="application/xml+oembed" href="https://tristannuvola.com/oembed?format=xml" title="Tristan Nuvola oEmbed">
    
    <!-- Favicon -->
    <link rel="icon" href="icons/favicon.ico" type="image/x-icon">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css"> 
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Include Dexie.js first (only if you need it; otherwise you can remove) -->
    <script src="https://unpkg.com/dexie@3.0.3/dist/dexie.min.js"></script>
    
    <!-- Then include your main script with 'defer' (if needed; remove if not used on contact page) -->
    <script defer src="script.js"></script>

    <!-- Include Cloudflare Turnstile Widget -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    
    <!-- Optional inline style for Turnstile spacing -->
    <style>
        /* Ensure Turnstile widget is visible */
        .cf-turnstile {
            margin: 20px 0;
        }
    </style>
</head>

<body>
    <!-- Main content container -->
    <div id="content">
        <!-- Header with back and patreon buttons, language toggle -->
        <header>
            <div class="header-content">
                <!-- Top Row -->
                <div class="top-row">
                    <div id="header-left">
                        <nav class="header-nav">
                            <!-- Adjust "Back" link as needed -->
                            <a href="index.html" id="back-link">Back</a>
                            <a href="https://www.patreon.com/tristannuvola" target="_blank" id="patreon-link">Patreon</a>
                        </nav>
                    </div>
                    <div class="language-toggle">
                        <button id="lang-toggle" class="lang-btn">Ita</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Contact Form -->
        <div id="contact-form-container">
            <h1 id="page-title">Leave feedback or request for takedown</h1>
            <form id="contact-form" method="POST" action="https://contact-form-worker.notaa.workers.dev">
                <label for="email" id="email-label">Your Email (optional):</label>
                <input type="email" id="email" name="email" placeholder="you@example.com">

                <label for="message" id="message-label">Your Message:</label>
                <textarea id="message" name="message" required></textarea>

                <!-- Cloudflare Turnstile Widget -->
                <div class="cf-turnstile" data-sitekey="0x4AAAAAAAyqLP0723YQLCis"></div>

                <button type="submit" id="submit-button">Send</button>
            </form>
        </div>

        <!-- Footer with theme toggle (or any other elements you like) -->
        <footer>
            <label class="theme-switch">
                <input type="checkbox" id="theme-toggle">
                <span class="slider"></span>
            </label>
        </footer>
    </div>

    <!-- Audio element (if desired) -->
    <audio id="background-audio" loop muted></audio>

    <!-- Link to external JavaScript file (contact.js) -->
    <script src="contact.js"></script>

    <!-- Cookie Handling & Redirection Script (optional) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            function getQueryParams() {
                const params = {};
                window.location.search.substring(1).split("&").forEach(function(part) {
                    const [key, value] = part.split("=");
                    if (key) params[decodeURIComponent(key)] = decodeURIComponent(value);
                });
                return params;
            }

            function setCookie(name, value, hours) {
                const d = new Date();
                d.setTime(d.getTime() + (hours*60*60*1000));
                const expires = "expires="+ d.toUTCString();
                document.cookie = name + "=" + value + ";" + expires + ";path=/";
            }

            function getCookie(name) {
                const cname = name + "=";
                const decodedCookie = decodeURIComponent(document.cookie);
                const ca = decodedCookie.split(';');
                for(let i = 0; i < ca.length; i++) {
                    let c = ca[i].trim();
                    if (c.indexOf(cname) === 0) {
                        return c.substring(cname.length, c.length);
                    }
                }
                return "";
            }

            function disableContactFormAndButton() {
                const contactForm = document.getElementById('contact-form');
                if (contactForm) {
                    contactForm.style.display = 'none';
                    const message = document.createElement('p');
                    message.textContent = "You have already contacted us. Please try again in 24 hours.";
                    message.style.color = 'gray';
                    message.style.marginTop = '20px';
                    contactForm.parentNode.appendChild(message);
                }

                const contactBtn = document.getElementById('contact-link');
                if (contactBtn) {
                    contactBtn.style.display = 'none';
                    const msg2 = document.createElement('p');
                    msg2.textContent = "You have already contacted us. Please try again in 24 hours.";
                    msg2.style.color = 'gray';
                    msg2.style.marginTop = '10px';
                    contactBtn.parentNode.appendChild(msg2);
                }
            }

            const params = getQueryParams();

            if (params.submitted && params.submitted === "true") {
                setCookie('formSubmitted', 'true', 24);
                if (window.history.replaceState) {
                    const url = new URL(window.location);
                    url.searchParams.delete('submitted');
                    window.history.replaceState({}, document.title, url.pathname);
                }
                disableContactFormAndButton();
            }

            const formSubmitted = getCookie('formSubmitted');
            if (formSubmitted === "true") {
                disableContactFormAndButton();
            }
        });
    </script>
</body>
</html>
